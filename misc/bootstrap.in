import os, subprocess

def after_install(options, home_dir):
    def call(*args):
        retcode = subprocess.call(*args)
        if retcode:
            raise RuntimeError("Exit status %d from command args %s" %
                               (retcode, args))
    call([join(home_dir, 'bin', 'easy_install'), 'virtualenv>=1.4.9'])
    call([join(home_dir, 'bin', 'easy_install'), 'pip'])
    call([join(home_dir, 'bin', 'easy_install'), 'paver'])
    call([join(home_dir, 'bin', 'paver'), 'post_bootstrap'])

def adjust_options(options, args):
    args[:] = ['./']

def extend_parser(optparse_parser):
    # flip-flop the default on whether to utilize site packages
    optparse_parser.remove_option('--no-site-packages')
    optparse_parser.add_option('--use-site-packages',
                               dest='no_site_packages',
                               action='store_false',
                               default=True)
    # Use distribute by default.
    optparse_parser.set_defaults(use_distribute=True)

